package com.nicetcm.nibsplus.broker.ams;

import java.rmi.registry.Registry;
import java.rmi.registry.LocateRegistry;
import java.rmi.server.UnicastRemoteObject;

import org.slf4j.LoggerFactory;
import org.slf4j.Logger;

public class AMSBrokerRMIServer {
    
    public static final Logger logger = LoggerFactory.getLogger(AMSBrokerRMIServer.class);
    public AMSBrokerRMIServer() {
        
    }
    
    public void bind() {
        
        try { 
            AMSBrokerRMIImpl remoteObj = new AMSBrokerRMIImpl();
            
            AMSBrokerRMI stub = (AMSBrokerRMI)UnicastRemoteObject.exportObject(remoteObj, 0);

            logger.debug("OK");
            // Bind the remote object's stub in the registry
            Registry registry = LocateRegistry.getRegistry();
            registry.rebind("AMSBrokerRMI", stub);
           //java.rmi.Naming.rebind("rmi://localhost:1099/AMSBrokerRMI", remoteObj); 
            logger.debug("AMSBrokerRMI Remote Object bound to the registry and ready to service incoming client calls..."); 
        }
        catch(java.rmi.RemoteException e) { 
            logger.error("Exception occurred during processing incoming method call");
            e.printStackTrace();
        }
        catch (Exception e) {
            logger.error("Server exception: " + e.toString());
            e.printStackTrace();
        }
    } 
}
