#USE_COL_CNT, COL_LEN, COL_TYPE 순으로 정의되어 져야 하며 SELECT 절 내부를 제외하고는 라인을 띄우면 안된다.
#SELECT 문의 COLUMN은 반드시 50개를 채워줘야 한다.(USE_COL_CNT 만큼 제외한 컬럼은 '' 등 으로 정의
USE_COL_CNT=33
COL_LEN=8,10,8,12,6,4,4,60,8,60,4,8,6,1,1,4,4,1,8,6,8,10,13,10,8,6,40,200,50,4,20,3,65
COL_TYPE=A,A,A,A,A,A,A,A,A,A,A,A,A,N,N,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A
SELECT   /*+ INDEX(MNG IX_T_CT_ERROR_MNG_04)*/ DECODE( NVL( MNG.format_type, '0' ), '21', MNG.trans_date, 
	 									      '11', MNG.trans_date, 
	 									            MNG.create_date ),
	     DECODE( NVL( MNG.format_type, '0' ), '21', MNG.org_msg_no, 
	 									      '11', MNG.org_msg_no,
	 									            MNG.create_time ),
         MNG.JIJUM_CD,
         MNG.mac_no,
         '',
         '',
         '',
         '',
         DECODE( MNG.ERROR_CD, 'NE100', 'WWONE',             /* 1 현금부족예보 */
					  'NE200', 'WWWWW',             /* 1 현금부족 WWOEE*/
					  'NE103', 'WWINE',             /* 2 현금입금 예보Full */
					  'NE203', 'WWIEE',             /* 2 현금입금 Full */
					  'NE101', 'CCONE',             /* 3 수표부족예보 */
					  'NE201', 'CCCCC',             /* 3 수표부족 CCOEE*/
					  'NE104', 'CCINE',             /* 4 수표입금 Full */
					  'NE204', 'CCIEE',             /* 4 수표입금 Full */
					  'NE205', 'WWBEE',             /* 5 현금회수 Full */
					  'NE102', 'JJONE',             /* 7 명세표부족예보 */
					  'NE202', 'JJJJJ',             /* 7 명세표부족 */
					  'NE113', 'PPINE',             /* 8 저널용지 부족예보 */
					  'NE213', 'PPIEE',             /* 8 저널용지 부족 */
					  'NE207', 'KKBEE',             /* 9 카드회수 Full */
					           MNG.ERROR_CD ) AS error_cd,
         '',
         '',
         '',
		 '',
		 '',
		 '',
		 DECODE( SUBSTR(MNG.error_status, 3, 1), '0', '0', '1' ),
         '',
         '',
         MNG.finish_date,
		 DECODE(MNG.finish_time, '', '', MNG.finish_time ),
         '',
         CASE WHEN MNG.org_send_yn = '2'
                    then DECODE(MNG.finish_nm, NULL, '나이스', MNG.finish_nm)
                WHEN MNG.org_send_yn = '3' and
                      MNG.finish_type = '0001' AND
                   MNG.finish_nm = '취소' AND
                   MNG.arrival_time IS NOT NULL
                   THEN DECODE(MNG.recv_user_nm, NULL,
                                    DECODE(MNG.recv_user_uid, NULL, '나이스', MBR.member_nm), MNG.recv_user_nm)
         END finishnm,
         '0800228252',
         '',
         MNG.arrival_date,
	     DECODE(MNG.arrival_time, '', '', MNG.arrival_time ),
         '',
         MNG.msg,
         '',
         '', 
         '',
         '', 
         '',
         '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''
   FROM T_CT_ERROR_MNG     MNG,
        T_CM_MEMBER        MBR
/* 콜 취소가 아닌것 중 예정시간이나 도착없이 완료된것도 보낼수 있도록 */    
WHERE MNG.org_cd = '032'
   AND MNG.send_time IS NOT NULL
   AND MNG.error_status IS NOT NULL
   AND (    MNG.org_send_yn = '1'
            OR (    MNG.arrival_est_time IS NULL
            	AND MNG.arrival_time IS NULL
                AND NVL( MNG.org_send_yn, '0' ) = '0'
               )
            OR (    arrival_est_time IS NULL
            	AND arrival_time IS NOT NULL
                AND NVL( org_send_yn, '0' ) = '0'
               )
       )
   /*AND ( NVL(MNG.repair_date, '0')||NVL(MNG.repair_time, '0') <> NVL(MNG.finish_date, '0')|| NVL(MNG.finish_time, '0') )*/
   AND ( MNG.format_type = '21' OR MNG.format_type = '11')
   AND MNG.CREATE_DATE > TO_NUMBER(TO_CHAR((SYSDATE - 3), 'YYYYMMDD'))
   AND MNG.recv_user_uid = MBR.member_id(+)
   AND substr(MNG.error_cd, 1, 3 ) <> 'ERR'
