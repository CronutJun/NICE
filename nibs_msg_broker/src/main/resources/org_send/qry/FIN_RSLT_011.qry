#USE_COL_CNT, COL_LEN, COL_TYPE 순으로 정의되어 져야 하며 SELECT 절 내부를 제외하고는 라인을 띄우면 안된다.
#SELECT 문의 COLUMN은 반드시 50개를 채워줘야 한다.(USE_COL_CNT 만큼 제외한 컬럼은 '' 등 으로 정의
USE_COL_CNT=34
COL_LEN=8,10,8,12,6,4,4,60,8,60,4,8,6,1,1,4,4,1,8,6,8,10,13,10,8,6,40,200,50,4,20,3,6,59
COL_TYPE=A,A,A,A,A,A,A,A,A,A,A,A,A,N,N,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A
SELECT /*+ INDEX(MNG IX_T_CT_ERROR_MNG_04)*/ MNG.trans_date,
         MNG.org_msg_no,
         MNG.JIJUM_CD,
         MNG.mac_no,
         MNG.org_site_cd,
         '',
         '',
         '',         
         '',
         '',
         '',
         '',
		 '',
		 DECODE( MNG.arrival_time, NULL, '1', '2' ),
		 DECODE(nvl(MNG.org_send_yn, '0'), '5', '2', '1'),
		 DECODE( MNG.error_status, '7000', '2', '1' ),
         DECODE( MNG.error_status, '7000', '', DECODE( SUBSTR(MNG.error_status, 4, 1),  '1', '0', 
										         										 '2', '1', 
										         										 '3', '2',
										         										 '4', '3',
										         										 '5', '4',
										         										 '6', '6',
										         										 '5' ) ),
         /*SUBSTR(MNG.as_medium, 2, 1),*/
         SUBSTR(AS1.ACCEPT_AS_CODE, 2, 1),
         DECODE(AS1.accept_time, '', DECODE(MNG.finish_time, '', TO_CHAR(SYSDATE, 'YYYYMMDD'), MNG.finish_date ), AS1.accept_date ) as finish_date,
		 DECODE(AS1.accept_time, '', DECODE(MNG.finish_time, '', TO_CHAR(SYSDATE, 'HH24MISS'), MNG.finish_time ), AS1.accept_time ) as finish_time,
         '',
         CASE WHEN nvl(MNG.org_send_yn, '0') = '2'
                    then DECODE(MNG.finish_nm, NULL, '나이스', MNG.finish_nm)
                WHEN nvl(MNG.org_send_yn, '0') = '3' and
                      MNG.finish_type = '0001' AND
                   MNG.finish_nm = '취소' AND
                   MNG.arrival_time IS NOT NULL
                   THEN DECODE(MNG.recv_user_nm, NULL,
                                    DECODE(MNG.recv_user_uid, NULL, '나이스', MBR.member_nm), MNG.recv_user_nm)
         END finishnm,
         '0800228252',
         '',
         '',
	     '',
         '',
         RTRIM( MNG.msg ),
         '',
         '', 
         OFC.OFFICE_NM,
         '', 
         MNG.create_time,
         '',
         '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''
   FROM T_CT_ERROR_MNG     MNG,
        T_CM_MEMBER        MBR,
        T_CT_ERROR         ERR,
        T_CT_AS            AS1,
        T_CM_OFFICE			OFC
/* 콜 취소가 아닌것 중 예정시간이나 도착없이 완료된것도 보낼수 있도록 */
WHERE MNG.org_cd = '011'
   AND MNG.error_status IS NOT NULL
   /* 완료장애 일경우 발생 복구 기준 5분 이상인 것만 완료가 아닐 경우는 AS접수 시간으로 넣기위해 발생 복구 시간 상관없음*/
   AND (    (       MNG.error_status = '7000' 
                AND MNG.repair_time <> '999999'
                AND TO_NUMBER((TO_DATE( MNG.repair_date||Mng.repair_time, 'YYYYMMDDHH24MISS') - TO_DATE( MNG.create_date||Mng.create_time, 'YYYYMMDDHH24MISS'))*24*60) >= 5
             )
          OR MNG.error_status <> '7000'
       )
   /*AND MNG.arrival_est_time IS NOT NULL*/
   AND (    nvl(MNG.org_send_yn, '0') = '2'
            /* 20100823 예정이없다면 보낼필요 없다.=>재 수정 20101108 예정 상관없이 전송  */
            OR (    MNG.arrival_est_time IS NULL
            	AND MNG.arrival_time IS NULL
                AND nvl(MNG.org_send_yn, '0') = '0'
               )
            OR (    MNG.arrival_est_time IS NOT NULL
            	AND MNG.arrival_time IS NULL
                AND nvl(MNG.org_send_yn, '0') = '1'
               )
            /* 도착이 은행에서 99 오류로 준것도 완료를 보내도록 한다. */   
            OR nvl(MNG.org_send_yn, '0') = 'b'
            /* AS 처리완료된건에대해서 완료 시간을 다시 보내도록 한다. 20090217 */
            OR nvl(MNG.org_send_yn, '0') = '5'            
       )
   /*
   AND ( NVL(MNG.repair_date, '0')||NVL(MNG.repair_time, '0') <> NVL(MNG.finish_date, '0')|| NVL(MNG.finish_time, '0') )
   */
   AND MNG.format_type = '21'
   AND MNG.org_msg_no IS NOT NULL
   AND MNG.CREATE_DATE >= TO_NUMBER(TO_CHAR((SYSDATE-3) , 'YYYYMMDD') )
   AND MNG.org_cd = ERR.org_cd(+)
   AND MNG.error_cd = ERR.error_cd(+)
   AND MNG.recv_user_uid = MBR.member_id(+)
   AND MNG.CREATE_DATE = AS1.CREATE_DATE(+)
   AND MNG.ERROR_NO = AS1.ERROR_NO(+)
   AND MNG.ORG_CD = AS1.ORG_CD(+)
   AND MNG.JIJUM_CD = AS1.JIJUM_CD(+)
   AND MNG.MAC_NO = AS1.MAC_NO(+)
   AND MNG.DEPT_CD = OFC.DEPT_CD
   AND MNG.OFFICE_CD = OFC.OFFICE_CD
   AND NVL(ERR.ERROR_MOT_YN, 'Y') = 'Y'
   