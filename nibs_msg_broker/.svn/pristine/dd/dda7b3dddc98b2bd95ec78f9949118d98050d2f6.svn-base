#USE_COL_CNT, COL_LEN, COL_TYPE 순으로 정의되어 져야 하며 SELECT 절 내부를 제외하고는 라인을 띄우면 안된다.
#SELECT 문의 COLUMN은 반드시 50개를 채워줘야 한다.(USE_COL_CNT 만큼 제외한 컬럼은 '' 등 으로 정의
USE_COL_CNT=22
COL_LEN=8,10,8,12,15,2,63,8,6,8,6,4,10,13,100,4,4,20,3,6,1,111
COL_TYPE=A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A
SELECT     MNG.trans_date,
           MNG.org_msg_no,
           MNG.JIJUM_CD,
           DECODE( substr( MNG.sec, 1, 1 ), '2', '',  DECODE(substr( MNG.sec, 1, 1 ), '8', '', MNG.mac_no ) ), /* 민원출동은 기번 없이 feedback */
           mng.crt_no,
           LPAD(MNG.org_call_cnt, 2, '0'),
           '',
           MNG.send_date,
		   MNG.send_time,
		   MNG.arrival_date,
		   DECODE( LENGTH(MNG.arrival_time), 4 , MNG.arrival_time||'00', MNG.arrival_time ),
		   SUBSTR(MNG.sec, 1, 1)||DECODE(SUBSTR(MNG.sec, 3, 1), NULL, '1', SUBSTR(MNG.sec, 3, 1)),
		   DECODE(MNG.recv_user_nm, NULL,
				DECODE(MNG.recv_user_uid, NULL, '나이스', MBR.member_nm),
						MNG.recv_user_nm),
		   DECODE(MBR.nice_hp, NULL, '0800228252', MBR.nice_hp),
		   MNG.org_msg,
		   SUBSTR(MNG.sec, 2, 1),
		   '', 
		   '', 
		   '', 
		   MNG.SITE_CD,
		   '', 
		   '', 
           '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''
      FROM T_CT_ERROR_MNG MNG,
		   T_CM_MEMBER	  MBR
     WHERE MNG.CREATE_DATE > TO_NUMBER(TO_CHAR((SYSDATE - 10), 'YYYYMMDD'))
       AND MNG.org_cd = '088' 
       AND MNG.arrival_time IS NOT NULL
       /* AND MNG.send_time IS NOT NULL */
       AND (    MNG.org_send_yn = '1'
            OR (    MNG.arrival_est_time IS NULL
                AND MNG.org_send_yn = '0'
               )
            /* 도착예정이 은행에서 99 오류로 준것도 도착을 보내도록 한다. */   
            OR MNG.org_send_yn = 'a'
            )
       /*AND (MNG.format_type = '21' OR MNG.format_type = '31')*/
	   /* sec : 출동요청구분 + 사유로 구성 */
	   AND MNG.sec IS NOT NULL
	   AND MNG.recv_user_uid = MBR.member_id(+)
       /* 2차출동요청에대한 키지원일경우 제외 */
   	   AND substr(MNG.sec, 3, 1) || MNG.ERROR_CD <> '2SH903'
union all
SELECT TRANS_DATE,
       ORG_MSG_NO,
       JIJUM_CD,
       MAC_NO,
       '',
       LPAD(org_call_cnt, 2, '0'),
       '',
       send_date,
       send_time,
       arrival_date,
       DECODE( LENGTH(arrival_time), 4 , arrival_time||'00', arrival_time ),
       DECODE(CALL_CLASS, NULL, ' ', CALL_CLASS)||DECODE(CALL_CNT_TYPE, NULL, ' ', CALL_CNT_TYPE ),
       DECODE(COM_MAN_NM, NULL, '나이스', COM_MAN_NM ),
       DECODE(COM_MAN_TEL_NO , NULL, '0800228252', FC_FN_SECURITY(COM_MAN_TEL_NO, '2') ),
       substr(ORG_MSG , 1, 100),
       CALL_TYPE,
       '', 
       '', 
       '', 
       SITE_CD,
       '', 
       '', 
       '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''
FROM T_CT_ERROR_MNG_MADE_COM
WHERE ORG_CD = '088'
AND   (		ORG_SEND_YN = '2'
       OR	(	ORG_SEND_YN = '1' AND ARRIVAL_EST_TIME IS NULL )
      )
AND	  ARRIVAL_TIME IS NOT NULL
AND	  ORG_MSG_NO IS NOT NULL
