#USE_COL_CNT, COL_LEN, COL_TYPE 순으로 정의되어 져야 하며 SELECT 절 내부를 제외하고는 라인을 띄우면 안된다.
#SELECT 문의 COLUMN은 반드시 50개를 채워줘야 한다.(USE_COL_CNT 만큼 제외한 컬럼은 '' 등 으로 정의
USE_COL_CNT=29
COL_LEN=8,6,8,6,8,10,8,12,6,4,4,60,8,60,4,4,1,8,10,8,10,13,100,50,4,20,3,15,52
COL_TYPE=N,N,N,N,N,A,A,A,A,A,A,A,A,A,A,A,N,A,A,A,A,A,A,A,A,A,A,A,A
SELECT     
	 '',
     '',
     CASE WHEN MNG.arrival_est_time IS NOT NULL
           THEN CASE WHEN MNG.send_time < MNG.arrival_est_time
                    THEN MNG.send_date
                    ELSE TO_CHAR(TO_DATE(MNG.send_date, 'YYYYMMDD') + 1, 'YYYYMMDD')
                    END
          ELSE TO_CHAR(TO_DATE(MNG.SEND_DATE||MNG.SEND_TIME, 'YYYYMMDDHH24MISS') + (30/24/60/60), 'YYYYMMDD')
          END AS est_date,
     CASE WHEN MNG.arrival_est_time IS NOT NULL
           THEN MNG.arrival_est_time || '00'
          ELSE TO_CHAR(TO_DATE(MNG.SEND_DATE||MNG.SEND_TIME, 'YYYYMMDDHH24MISS') + (30/24/60/60), 'HH24MISS') 
          END AS est_time,
     MNG.create_date,
     MNG.ORG_MSG_NO, /*MNG.create_time,*/
     MNG.jijum_cd,
     MNG.mac_no,
     MNG.site_cd,
     '',
     '',
     '',
     CASE WHEN LENGTH(MNG.ERROR_CD) = 2 
     		THEN MNG.ERROR_CD
    		ELSE
    		(SELECT CD_NM2 FROM T_CM_COMMON WHERE LARGE_CD = '1130'
	 							AND	CD_NM3 = ERR.ORG_CD
	 							AND CD_NM1 = ERR.GROUP_ERROR_CD)
      END
	 ,							
     /*
     CASE WHEN substr(MNG.error_cd, 1, 3) <> 'ERR' AND substr(MNG.error_cd, 1, 2) <> 'NE'
          THEN MNG.made_err_cd
          ELSE MNG.error_cd
          END AS error_cd, */
     '',
     CASE WHEN substr(MNG.error_cd, 1, 2) = 'NE' 
          THEN '0' /* 상태 */
          ELSE CASE WHEN substr(MNG.error_cd, 1, 3) = 'ERR' 
                      THEN '2' /* 나이스접수장애 */
                      ELSE '1' /* H/W장애 */
                         END
          END AS ERROR_TYPE,
     '',
     '',
     '',
     '',
     '',
     DECODE(MNG.recv_user_nm, NULL, 'NICE', MNG.recv_user_nm),
     DECODE(MNG.recv_tele_no, NULL, '0800228252', MNG.recv_tele_no),
     replace(substrb(MNG.msg, 1, 98), CHR(10), ' '),
     '',
     '',
     '',
     '', 
     '', 
     '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''
  FROM T_CT_ERROR_MNG MNG
      ,T_CT_ERROR ERR
  WHERE MNG.CREATE_DATE > TO_CHAR((SYSDATE - 3), 'YYYYMMDD')
    AND MNG.org_cd = '031'
    AND MNG.send_time IS NOT NULL
    AND MNG.trans_date IS NOT NULL
    AND MNG.ORG_CD = ERR.ORG_CD
    AND MNG.ERROR_CD = ERR.ERROR_CD
    AND (
            MNG.arrival_est_time IS NOT NULL 
         OR ( 
                MNG.arrival_est_time IS NULL AND
                MNG.arrival_time IS NOT NULL
            ) 
        )
	AND 
	(
		(
			SUBSTR(MNG.error_cd, 1, 3) = 'ERR'
			AND MNG.org_send_yn = '0'
		)
		OR	(SUBSTR(MNG.error_cd, 1, 2) <> 'NE' 
				AND NVL(MNG.org_send_yn, '0') = '0') 
	)
		
